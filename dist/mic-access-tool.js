!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MicAccessTool=e():t.MicAccessTool=e()}(self,(()=>(()=>{"use strict";function t(t){this.init=t||{},this.removedImages=[],this.imagesHidden=!1,this.isMuted=!1,this.selectedHeaderColor="#393636",this.initializeAccessibilityToolbox(),this.initBlueFilter(),this.initRemoveImages(),this.addFontSizePopup(),this.initZoomToggleFeature(),this.initNightModeFeature(),this.initTextSpacingFeature(),this.initLineHeightFeature(),this.initResetFeature(),this.initContrastFeature(),this.addSettingsButtonListener(),this.addDevelopmentAlerts()}return t.prototype.createEle=function(t,e={},o=""){const n=document.createElement(t);for(const[t,o]of Object.entries(e))n.setAttribute(t,o);return o&&(n.innerText=o),n},t.prototype.createButton=function(t,e,o=""){const n=this.createBaseButton(t),i=this.createIconWrapper(o,e||t);if(i&&n.appendChild(i),e){const t=this.createTextWrapper(e);n.appendChild(t)}return n},t.prototype.createBaseButton=function(t){const e=document.createElement("button");return e.className="syi-toolbox-button",e.id=t,e},t.prototype.createIconWrapper=function(t,e){if(!t)return null;const o=document.createElement("div");if(o.className="icon-wrapper",t.startsWith("./")||t.startsWith("/"))this.fetchAndAppendSVG(t,o);else if(t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")){const n=this.createImageIcon(t,e);o.appendChild(n)}else{const e=this.createFontAwesomeIcon(t);o.appendChild(e)}return o},t.prototype.fetchAndAppendSVG=function(t,e){fetch(t).then((t=>t.text())).then((t=>{const o=document.createElement("div");o.innerHTML=t;const n=o.querySelector("svg");n&&(n.classList.add("button-icon"),e.appendChild(n))})).catch((t=>console.error("Error fetching SVG:",t)))},t.prototype.createImageIcon=function(t,e){const o=document.createElement("img");return o.src=t,o.alt=e,o.className="button-icon",o},t.prototype.createFontAwesomeIcon=function(t){const e=document.createElement("span");return e.innerHTML=t,e.className="font-awesome-icon",e},t.prototype.createTextWrapper=function(t){const e=document.createElement("span");return e.className="text-wrapper",e.textContent=t,e},t.prototype.createButtonWithIcon=function(t,e){const o=document.createElement("button");o.className="header-btn",o.id=t;const n=document.createElement("span");return n.className=e,o.appendChild(n),o},t.prototype.createDiv=function(t,e=""){const o={class:t};return e&&(o.id=e),this.createEle("div",o)},t.prototype.createImage=function(t,e,o){return this.createEle("img",{src:t,alt:e,class:o})},t.prototype.createHeading=function(t,e,o=""){return this.createEle(`h${t}`,{class:o},e)},t.prototype.createDiv=function(t,e=""){const o={class:t};return e&&(o.id=e),this.createEle("div",o)},t.prototype.createImage=function(t,e,o){return this.createEle("img",{src:t,alt:e,class:o})},t.prototype.createHeading=function(t,e,o=""){return this.createEle(`h${t}`,{class:o},e)},t.prototype.createToolbox=function(){const t=this.createDiv("syi-toolbox hidden","syi-toolbox"),e=this.createToolboxHeader(),o=this.createToolboxBody();t.appendChild(e),t.appendChild(o),document.body.appendChild(t),this.resetButtonStates()},t.prototype.createToolboxHeader=function(){const t=this.createDiv("syi-toolbox-header"),e=this.createHeaderLeftSection(),o=this.createLogo(),n=this.createTitle("Site Point Eye Assistant"),i=this.createHeaderRightSection();return t.appendChild(e),t.appendChild(o),t.appendChild(n),t.appendChild(i),t},t.prototype.createHeaderLeftSection=function(){const t=this.createDiv("syi-toolbox-header-left");t.style.position="relative",t.style.bottom="28%";const e=this.createButtonWithIcon("settings-btn","fas fa-cog");e.addEventListener("click",(()=>createSettingsPopup())),t.appendChild(e);const o=this.createButtonWithIcon("reset-btn","fas fa-undo");return o.addEventListener("click",(()=>initResetFeature())),t.appendChild(o),t},t.prototype.createHeaderRightSection=function(){const t=this.createDiv("syi-toolbox-header-right");t.style.position="relative",t.style.bottom="28%";const e=this.createButtonWithIcon("info-btn","fas fa-info-circle");t.appendChild(e);const o=this.createButtonWithIcon("close-btn","fas fa-times");return o.addEventListener("click",(()=>this.closeToolboxFromButton())),t.appendChild(o),t},t.prototype.closeToolboxFromButton=function(){const t=document.querySelector(".syi-toolbox");t&&(t.classList.remove("visible"),console.log("Toolbox has been closed."))},t.prototype.createLogo=function(){const t=document.createElement("img");return t.src="https://your-inclusion.s3.ap-south-1.amazonaws.com/Your_Inclusion/icons/image.png",t.alt="Logo",t.className="syi-toolbox-logo",t},t.prototype.createTitle=function(t){const e=document.createElement("h2");return e.className="syi-toolbox-title",e.textContent=t,e},t.prototype.createToolboxBody=function(){const t=this.createDiv("syi-toolbox-body");return[{id:"blue-filter-btn",text:"Blue Filter",iconClass:"./assests/BlueFilter-1.svg"},{id:"contrast-btn",text:"Contrast Modes",iconClass:"./assests/contrast.svg"},{id:"remove-images-btn",text:"Remove Images",iconClass:"./assests/image-off.svg"},{id:"font-size-btn",text:"Font Size",iconClass:"./assests/fontsize.svg"},{id:"night-mode-btn",text:"Night Mode",iconClass:"./assests/mode-night.svg"},{id:"text-spacing-btn",text:"Text Spacing",iconClass:"./assests/ri_text-spacing 2.svg"},{id:"line-height-btn",text:"Line Height",iconClass:"./assests/ri_line-height 1.svg"},{id:"remove-audio-btn",text:"Remove Audio",iconClass:"./assests/mdi_mute 1.svg"},{id:"highlight-links-btn",text:"Highlight Links",iconClass:"./assests/link 1.svg"},{id:"highlight-headers-btn",text:"Highlight Headers",iconClass:"./assests/cil_header 1.svg"},{id:"stop-animations-btn",text:"Stop Animations",iconClass:"./assests/stop 1.svg"},{id:"zoom-toggle-btn",text:"Zoom",iconClass:"./assests/zoom 1.svg"},{id:"cursor-size-btn",text:"Change Cursor Size",iconClass:"./assests/cursor 1.svg"},{id:"accessible-font-btn",text:"Accessible Font",iconClass:"./assests/font 1.svg"},{id:"read-aloud-btn",text:"Read Aloud",iconClass:"./assests/read-aloud.svg"},{id:"reset-btn1",text:"Reset",iconClass:"./assests/reset 1.svg"},{id:"save-settings-btn",text:"Save",iconClass:"./assests/save 1.svg"}].forEach((({id:e,text:o,iconClass:n})=>{const i=this.createDiv(e||o.replace(/\s+/g,"-").toLowerCase()),s=this.createButton(e,o,n);i.appendChild(s),t.appendChild(i)})),t},t.prototype.arePopupsInactive=function(){const t=!this.isFontSizePopupActive&&!this.isSettingsPopupActive&&!this.isContrastPopupActive;return console.log(`Are all popups inactive? ${t}`),t},t.prototype.initializeAccessibilityToolbox=function(){this.createToolbox(),this.createSideButton();const t=document.getElementById("syi-toolbox"),e=document.getElementById("openToolboxButton");e.addEventListener("click",(e=>{e.stopPropagation(),t.classList.toggle("visible")})),document.addEventListener("click",(o=>{t.classList.contains("visible")&&(this.arePopupsInactive()?t.contains(o.target)||e.contains(o.target)||(t.classList.remove("visible"),console.log("Toolbox closed as all popups are inactive.")):console.log("Toolbox remains open because a popup is active."))})),this.loadToolbarState()},t.prototype.createSideButton=function(){const t=this.createSideButtonElement();this.makeSideButtonDraggable(t),document.body.appendChild(t)},t.prototype.createSideButtonElement=function(){const t=this.createDiv("side-button","openToolboxButton"),e=this.createImage("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRmaznO2w-h9n4bz-pEGtsiqy0J1JGh-wlMCw&s","Open Toolbox","side-button-image");return t.appendChild(e),t},t.prototype.makeSideButtonDraggable=function(t){t.addEventListener("mousedown",(e=>this.startDragging(e,t))),document.addEventListener("mousemove",(e=>this.dragSideButton(e,t))),document.addEventListener("mouseup",(()=>this.stopDragging()))},t.prototype.startDragging=function(t,e){this.isDragging=!0,this.offsetX=t.clientX-e.offsetLeft,this.offsetY=t.clientY-e.offsetTop,document.body.style.cursor="move"},t.prototype.dragSideButton=function(t,e){if(!this.isDragging)return;let o=t.clientX-this.offsetX,n=t.clientY-this.offsetY;const i=window.innerWidth;o=o+e.offsetWidth/2<i/2?10:i-e.offsetWidth-20,e.style.left=`${o}px`,e.style.top=`${n}px`,this.updateToolboxPosition(o,n,e)},t.prototype.stopDragging=function(){this.isDragging=!1,document.body.style.cursor="default"},t.prototype.updateToolboxPosition=function(t,e,o){const n=document.getElementById("syi-toolbox");if(!n)return;let i=t+o.offsetWidth/2-n.offsetWidth/2,s=e-n.offsetHeight-60;const a=window.innerWidth,l=window.innerHeight;i=Math.max(10,Math.min(i,a-n.offsetWidth-10)),s=Math.max(10,Math.min(s,l-n.offsetHeight-10)),n.style.left=`${i}px`,n.style.top=`${s}px`,o.style.top=`${s+n.offsetHeight+10}px`;const c=i<a/2;this.updatePopupPositions(c)},t.prototype.updatePopupPositions=function(t){[{selector:".font-size-popup",left:t?"25%":"74%"},{selector:".settings-popup",left:t?"28%":"71%"},{selector:".contrast-popup",left:t?"30%":"70%"}].forEach((({selector:t,left:e})=>{const o=document.querySelector(t);o&&o.style.setProperty("left",e,"important")}))},t.prototype.initBlueFilter=function(){const t=document.getElementById("blue-filter-btn");t?t.addEventListener("click",(()=>{const t=document.querySelector(".blue-overlay");if(t)t.remove(),this.setActiveButton("blue-filter-btn",!1);else{const t=this.createDiv("blue-overlay");document.body.appendChild(t),t.classList.add("active"),this.setActiveButton("blue-filter-btn",!0)}})):console.error("Blue Filter button is missing.")},t.prototype.initRemoveImages=function(){const t=document.getElementById("remove-images-btn");t&&t.addEventListener("click",(()=>{this.toggleImages(),this.setActiveButton("remove-images-btn")}))},t.prototype.toggleImages=function(){const t=document.querySelectorAll("img:not(.syi-toolbox-image):not(.side-button-image):not(.syi-toolbox-logo)");this.imagesHidden?t.forEach((t=>{t.classList.remove("hidden-image")})):t.forEach((t=>{t.classList.add("hidden-image")})),this.imagesHidden=!this.imagesHidden},t.prototype.initAudioRemoval=function(){const t=document.getElementById("remove-audio-btn");t&&t.addEventListener("click",(()=>{this.audioRemoval(),this.setActiveButton("remove-audio-btn")}))},t.prototype.audioRemoval=function(){const t=document.querySelectorAll("audio, video");this.isMuted=!this.isMuted,t.forEach((t=>{t.muted=this.isMuted}))},t.prototype.initReadAloud=function(){const t=document.getElementById("read-aloud-btn");t&&t.addEventListener("click",(()=>{this.toggleReadAloud("read-aloud-btn")})),"true"===localStorage.getItem("readAloudActive")&&(this.enableDefaultClickToRead(),this.createReadAloudToolbar(),this.setActiveButton("read-aloud-btn",!0))},t.prototype.toggleReadAloud=function(t){const e=document.getElementById("read-aloud-toolbar");this.isReadAloudActive?(this.disableDefaultClickToRead(),this.stopReadAloud(),e&&e.classList.add("hidden"),this.setActiveButton(t,!1),this.isReadAloudActive=!1,localStorage.setItem("readAloudActive",!1),console.log("Read Aloud deactivated.")):(e?e.classList.remove("hidden"):this.createReadAloudToolbar(),this.enableDefaultClickToRead(),this.setActiveButton(t,!0),this.isReadAloudActive=!0,localStorage.setItem("readAloudActive",!0),console.log("Read Aloud activated."))},t.prototype.createReadAloudToolbar=function(){const t=this.createDiv("read-aloud-toolbar","read-aloud-toolbar"),e=this.createDiv("toolbar-header"),o=this.createHeading(2,"Read Aloud Settings","toolbar-title"),n=this.createButton("close-toolbar","✖");n.addEventListener("click",(()=>{t.remove(),this.disableDefaultClickToRead()})),e.appendChild(o),e.appendChild(n),t.appendChild(e);const i=this.createDiv("toolbar-controls"),s=this.createButton("cursor-read-btn","Cursor Read Aloud");s.innerHTML='<i class="fas fa-mouse-pointer"></i> Cursor Read Aloud',s.addEventListener("click",this.enableCursorReadAloud.bind(this));const a=this.createButton("previous-line-btn","Previous Line");a.innerHTML='<i class="fas fa-arrow-left"></i> ',a.addEventListener("click",this.readPreviousLine.bind(this));const l=this.createButton("play-read-btn","▶");l.innerHTML='<i class="fas fa-play"></i>',l.addEventListener("click",this.playReadAloud.bind(this));const c=this.createButton("stop-read-btn","⏹");c.innerHTML='<i class="fas fa-stop"></i>',c.addEventListener("click",this.stopReadAloud.bind(this));const r=this.createButton("next-line-btn","Next Line");r.innerHTML='<i class="fas fa-arrow-right"></i> ',r.addEventListener("click",this.readNextLine.bind(this));const d=document.createElement("div");d.className="sliders-container";const u=document.createElement("div");u.className="slider-wrapper";const p=document.createElement("label");p.setAttribute("for","volume-slider"),p.textContent="Volume:",u.appendChild(p);const h=document.createElement("input");h.type="range",h.id="volume-slider",h.min="0",h.max="1",h.step="0.1",h.value=this.currentVolume||1,h.addEventListener("input",(t=>{this.currentVolume=parseFloat(t.target.value),console.log(`Volume updated to: ${this.currentVolume}`)})),u.appendChild(h);const g=document.createElement("div");g.className="slider-wrapper";const m=document.createElement("label");m.setAttribute("for","speed-slider"),m.textContent="Speed:",g.appendChild(m);const y=document.createElement("input");y.type="range",y.id="speed-slider",y.min="0.5",y.max="2",y.step="0.1",y.value=this.currentSpeed||1,y.addEventListener("input",(t=>{this.currentSpeed=parseFloat(t.target.value),console.log(`Speed updated to: ${this.currentSpeed}`)})),g.appendChild(y),d.appendChild(u),d.appendChild(g),g.appendChild(y),i.appendChild(s),i.appendChild(a),i.appendChild(l),i.appendChild(c),i.appendChild(r),i.appendChild(d),t.appendChild(i),document.body.appendChild(t)},t.prototype.highlightText=function(t,e,o){const n=t.dataset.originalText||t.innerText||"",i=n.slice(0,e),s=n.slice(e,e+o),a=n.slice(e+o);t.innerHTML=`${i}<span style="background-color: yellow;">${s}</span>${a}`},t.prototype.enableDefaultClickToRead=function(){document.querySelectorAll("h1, h2, h3, h4, h5, h6, p, a, button").forEach((t=>{t.addEventListener("click",this.readElementContent.bind(this))}))},t.prototype.disableDefaultClickToRead=function(){document.querySelectorAll("h1, h2, h3, h4, h5, h6, p, a, button").forEach((t=>{t.removeEventListener("click",this.readElementContent.bind(this))}))},t.prototype.readElementContent=function(t){const e=t.target,o=e.innerText||e.value||"",n=new SpeechSynthesisUtterance(o);n.volume=this.currentVolume||1,n.rate=this.currentSpeed||1;const i=o.split(" ");let s=0;n.onboundary=t=>{if("word"===t.name){const o=t.charIndex,n=i[s]?.length||0;this.highlightText(e,o,n),s++}},n.onend=()=>{this.clearHighlight(e)},speechSynthesis.speak(n)},t.prototype.clearHighlight=function(t){t.dataset.originalText&&(t.innerHTML=t.dataset.originalText)},t.prototype.playReadAloud=function(){this.isReadAloudActive?document.querySelectorAll("p").length?(this.currentParagraphIndex=0,this.readCurrentLine()):console.log("No paragraphs found to read."):console.log("Read Aloud is not active. Please enable it first.")},t.prototype.enableCursorReadAloud=function(){document.querySelectorAll("h1, h2, h3, h4, h5, h6, p, a, button").forEach((t=>{let e;t.addEventListener("mouseenter",(()=>{e=setTimeout((()=>{const e=new SpeechSynthesisUtterance(t.innerText||t.value||"");e.volume=this.currentVolume||1,e.rate=this.currentSpeed||1,this.highlightText(t,0,t.innerText.length),speechSynthesis.speak(e)}),1e3)})),t.addEventListener("mouseleave",(()=>{clearTimeout(e),speechSynthesis.cancel()}))}))},t.prototype.readPreviousLine=function(){this.currentParagraphIndex>0?(this.currentParagraphIndex--,this.readCurrentLine()):console.log("Already at the first paragraph.")},t.prototype.readNextLine=function(){const t=document.querySelectorAll("p");void 0===this.currentParagraphIndex&&(this.currentParagraphIndex=0),this.currentParagraphIndex<t.length-1?(this.currentParagraphIndex++,this.readCurrentLine()):console.log("No more paragraphs to read.")},t.prototype.speakText=function(t){const e=t.innerText||"",o=new SpeechSynthesisUtterance(e);o.volume=this.currentVolume||1,o.rate=this.currentSpeed||1,t.dataset.originalText||(t.dataset.originalText=e);const n=e.split(" ");let i=0;o.onboundary=e=>{if("word"===e.name){const o=e.charIndex,s=n[i]?.length||0;this.highlightText(t,o,s),i++}},o.onend=()=>{this.clearHighlight(t)},speechSynthesis.cancel(),speechSynthesis.speak(o)},t.prototype.readCurrentLine=function(){const t=document.querySelectorAll("h1,h2,h3,h4,h5,h6,p");if(void 0===this.currentParagraphIndex||this.currentParagraphIndex>=t.length)return void console.log("No more paragraphs to read.");const e=t[this.currentParagraphIndex];this.speakText(e)},t.prototype.stopReadAloud=function(){speechSynthesis.cancel(),this.currentParagraphIndex=void 0,document.querySelectorAll("[data-original-text]").forEach((t=>{this.clearHighlight(t)})),console.log("Read Aloud stopped, and all highlights cleared.")},document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelectorAll(".syi-toolbox-button");t.forEach((e=>{e.addEventListener("click",(()=>{t.forEach((t=>t.style.backgroundColor="rgba(255, 255, 255, 0.3)")),e.style.backgroundColor="rgba(52, 88, 185, 1)"}))}))})),t.prototype.addFontSizePopup=function(){const t=document.querySelector(".font-size-btn"),e=document.querySelector(".syi-toolbox-body");t&&e?t.addEventListener("click",(()=>{let t=document.querySelector(".font-size-popup");if(!t){t=document.createElement("div"),t.className="font-size-popup",t.innerHTML='\n                <div class="font-popup-header">\n                    <span class="font-popup-title">Font Size Settings</span>\n                    <button id="close-font-popup" class="close-popup-btn">✖</button>\n                </div>\n                <div class="font-popup-content">\n                    <button id="decrease-font-btn" class="font-popup-btn">-</button>\n                    <span id="font-size-display" class="font-popup-display">0</span>\n                    <button id="increase-font-btn" class="font-popup-btn">+</button>\n                </div>\n                <div class="font-popup-reset">\n                    <button id="reset-font-btn" class="reset-popup-btn">Reset</button>\n                </div>\n            ',document.body.appendChild(t);const o=e.getBoundingClientRect();t.style.top=`${o.top+20}px`,t.style.left=`${o.left+20}px`;const n=t.querySelector("#decrease-font-btn"),i=t.querySelector("#increase-font-btn"),s=t.querySelector("#reset-font-btn"),a=t.querySelector("#font-size-display"),l=t.querySelector("#close-font-popup");let c=0;const r=new Map,d=document.body.querySelectorAll("*:not(.syi-toolbox):not(.syi-toolbox *):not(.font-size-popup):not(.font-size-popup *)");d.forEach((t=>{const e=window.getComputedStyle(t);r.set(t,e.fontSize)}));const u=t=>{d.forEach((e=>{const o=parseFloat(r.get(e))+t;e.style.fontSize=`${o}px`}))},p=()=>{a.textContent=c>0?`+${c}`:`${c}`};n.addEventListener("click",(()=>{c>-6&&(c-=1,u(c),p())})),i.addEventListener("click",(()=>{c<6&&(c+=1,u(c),p())})),s.addEventListener("click",(()=>{d.forEach((t=>{t.style.fontSize=r.get(t)})),c=0,p()})),l.addEventListener("click",(()=>{t.style.display="none"}))}"block"===t.style.display?(t.style.display="none",this.isFontSizePopupActive=!1):(this.closeAllPopups(),t.style.display="block",this.isFontSizePopupActive=!0)})):console.error("Font Size button or toolbox not found.")},t.prototype.initHighlightButtons=function(){const t=document.getElementById("highlight-links-btn");t&&t.addEventListener("click",(()=>{this.highlightContent("links"),this.setActiveButton("highlight-links-btn")}));const e=document.getElementById("highlight-headers-btn");e&&e.addEventListener("click",(()=>{this.highlightContent("headers"),this.setActiveButton("highlight-headers-btn")}));const o=document.getElementById("highlight-images-btn");o&&o.addEventListener("click",(()=>{this.highlightContent("images"),this.setActiveButton("highlight-images-btn")}))},t.prototype.highlightContent=function(t){const e=`highlight-${t}`;let o;if("links"===t)o="a";else if("headers"===t)o="h1, h2, h3, h4, h5, h6";else{if("images"!==t)return void console.warn("Invalid type for highlightContent");o="img"}const n=document.querySelectorAll(o);0!==n.length?(n.forEach((o=>{if("images"===t)if(o.parentNode.classList.contains(e)){const t=o.parentNode;t.replaceWith(...t.childNodes)}else{const t=document.createElement("div");t.className=e,o.parentNode.insertBefore(t,o),t.appendChild(o);const n=o.alt||"No title available",i=document.createElement("span");i.textContent=n,t.appendChild(i)}else o.classList.toggle(e)})),console.log(`${n.length} ${t} elements toggled for highlighting.`)):console.warn(`No ${t} found to highlight.`)},t.prototype.getHighlightedButtons=function(){const t=[];return document.querySelectorAll(".highlight-links, .highlight-headers, .highlight-images").forEach((e=>{e.classList.contains("active")&&t.push(e.id)})),t},t.prototype.stopAnimations=function(){const t=document.body.classList.toggle("disable-animations");localStorage.setItem("animationsDisabled",t),t?(console.log("Animations and transitions disabled."),this.setActiveButton("stop-animations-btn")):(console.log("Animations and transitions re-enabled."),this.setActiveButton(null))},t.prototype.restoreAnimationState=function(){"true"===localStorage.getItem("animationsDisabled")?(document.body.classList.add("disable-animations"),console.log("Restored: Animations are disabled."),this.setActiveButton("stop-animations-btn")):this.setActiveButton(null)},t.prototype.initStopAnimationsButton=function(){const t=document.getElementById("stop-animations-btn");t&&t.addEventListener("click",this.stopAnimations.bind(this))},t.prototype.initialApp=function(){this.restoreAnimationState(),console.log("Accessibility toolbox initialized.")},t.prototype.initZoomToggleFeature=function(){this.zoomStates=[1,1.25,1.5,1.75],this.zoomIndex=0;const t=document.getElementById("zoom-toggle-btn");t&&t.addEventListener("click",this.toggleZoom.bind(this)),this.restoreZoomState()},t.prototype.toggleZoom=function(){this.zoomIndex=(this.zoomIndex+1)%this.zoomStates.length;const t=this.zoomStates[this.zoomIndex];this.applyZoom(t);const e=1!==t;this.setActiveButton("zoom-toggle-btn",e),console.log(`Zoom level toggled to: ${t}`)},t.prototype.applyZoom=function(t){document.querySelectorAll("body > *:not(#syi-toolbox):not(#openToolboxButton):not(img)").forEach((e=>{e.style.transform=`scale(${t})`,e.style.transformOrigin="0 0",e.style.width=100/t+"%"})),this.saveZoomState(t),console.log(`Zoom level applied: ${t}`)},t.prototype.restoreZoomState=function(){const t=parseFloat(localStorage.getItem("zoomLevel"))||1;this.applyZoom(t),this.zoomIndex=this.zoomStates.indexOf(t),-1===this.zoomIndex&&(this.zoomIndex=0);const e=1!==t;this.setActiveButton("zoom-toggle-btn",e)},t.prototype.saveZoomState=function(t){localStorage.setItem("zoomLevel",t),console.log(`Zoom level saved: ${t}`)},t.prototype.initNightModeFeature=function(){const t=document.getElementById("night-mode-btn");t&&t.addEventListener("click",(()=>{this.toggleNightMode()}));const e="true"===localStorage.getItem("nightMode");document.body.classList.toggle("night-mode",e),this.setActiveButton("night-mode-btn",e)},t.prototype.toggleNightMode=function(){const t=document.querySelectorAll(":not(button):not(input):not(.syi-toolbox):not(.syi-toolbox *)"),e=document.body.classList.toggle("night-mode");localStorage.setItem("nightMode",e),t.forEach((t=>{e?t.classList.add("night-mode"):t.classList.remove("night-mode")})),this.setActiveButton("night-mode-btn",e),console.log(`Night Mode ${e?"enabled":"disabled"}.`)},t.prototype.initTextSpacingFeature=function(){const t=document.getElementById("text-spacing-btn");t&&t.addEventListener("click",(()=>{this.toggleTextSpacing("text-spacing-btn")}))},t.prototype.toggleTextSpacing=function(t){const e=document.querySelectorAll("body *:not(.syi-toolbox):not(.syi-toolbox *)"),o=["normal","0.1em","0.2em","0.3em"];void 0===this.currentTextSpacingIndex&&(this.currentTextSpacingIndex=0),this.currentTextSpacingIndex=(this.currentTextSpacingIndex+1)%o.length;const n=o[this.currentTextSpacingIndex];e.forEach((t=>{t.style.letterSpacing=n}));const i="normal"!==n;this.setActiveButton(t,i),console.log(`Text spacing set to: ${n}`)},t.prototype.initLineHeightFeature=function(){const t=document.getElementById("line-height-btn");t&&t.addEventListener("click",(()=>{this.toggleLineHeight("line-height-btn")}))},t.prototype.toggleLineHeight=function(t){const e=document.querySelectorAll("body *:not(.syi-toolbox):not(.syi-toolbox *)"),o=["normal","1.5","2","2.5"];void 0===this.currentLineHeightIndex&&(this.currentLineHeightIndex=0),this.currentLineHeightIndex=(this.currentLineHeightIndex+1)%o.length;const n=o[this.currentLineHeightIndex];e.forEach((t=>{t.style.lineHeight=n})),"normal"===n?this.setActiveButton(t,!1):this.setActiveButton(t,!0),console.log(`Line height set to: ${n}`)},t.prototype.initCursorSizeAdjustment=function(){const t=document.getElementById("cursor-size-btn");t&&t.addEventListener("click",(()=>{this.toggleCursorSize("cursor-size-btn")}))},t.prototype.toggleCursorSize=function(t){const e=[{size:"normal",cursor:"auto",label:"Normal",icon:'<i class="fas fa-mouse-pointer"></i>'},{size:"medium",cursor:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="40" width="27.5" viewBox="0 0 320 512"><path fill="%23e0e0e0" d="M0 55.2L0 426c0 12.2 9.9 22 22 22c6.3 0 12.4-2.7 16.6-7.5L121.2 346l58.1 116.3c7.9 15.8 27.1 22.2 42.9 14.3s22.2-27.1 14.3-42.9L179.8 320l118.1 0c12.2 0 22.1-9.9 22.1-22.1c0-6.3-2.7-12.3-7.4-16.5L38.6 37.9C34.3 34.1 28.9 32 23.2 32C10.4 32 0 42.4 0 55.2z"/></svg>\') 40 40, auto',label:"Medium",icon:'<i class="fas fa-expand-alt"></i>'},{size:"large",cursor:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="60" width="37.5" viewBox="0 0 320 512"><path fill="%23e0e0e0" d="M0 55.2L0 426c0 12.2 9.9 22 22 22c6.3 0 12.4-2.7 16.6-7.5L121.2 346l58.1 116.3c7.9 15.8 27.1 22.2 42.9 14.3s22.2-27.1 14.3-42.9L179.8 320l118.1 0c12.2 0 22.1-9.9 22.1-22.1c0-6.3-2.7-12.3-7.4-16.5L38.6 37.9C34.3 34.1 28.9 32 23.2 32C10.4 32 0 42.4 0 55.2z"/></svg>\') 70 70, auto',label:"Large",icon:'<i class="fas fa-expand"></i>'},{size:"medium",cursor:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="40" width="27.5" viewBox="0 0 320 512"><path fill="%23000000" d="M0 55.2L0 426c0 12.2 9.9 22 22 22c6.3 0 12.4-2.7 16.6-7.5L121.2 346l58.1 116.3c7.9 15.8 27.1 22.2 42.9 14.3s22.2-27.1 14.3-42.9L179.8 320l118.1 0c12.2 0 22.1-9.9 22.1-22.1c0-6.3-2.7-12.3-7.4-16.5L38.6 37.9C34.3 34.1 28.9 32 23.2 32C10.4 32 0 42.4 0 55.2z"/></svg>\') 20 20, auto',label:"Medium Black",icon:'<i class="fas fa-circle"></i>'},{size:"large",cursor:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="60" width="37.5" viewBox="0 0 320 512"><path fill="%23000000" d="M0 55.2L0 426c0 12.2 9.9 22 22 22c6.3 0 12.4-2.7 16.6-7.5L121.2 346l58.1 116.3c7.9 15.8 27.1 22.2 42.9 14.3s22.2-27.1 14.3-42.9L179.8 320l118.1 0c12.2 0 22.1-9.9 22.1-22.1c0-6.3-2.7-12.3-7.4-16.5L38.6 37.9C34.3 34.1 28.9 32 23.2 32C10.4 32 0 42.4 0 55.2z"/></svg>\') 30 30, auto',label:"Large Black",icon:'<i class="fas fa-circle-notch"></i>'}];void 0===this.currentCursorSizeIndex&&(this.currentCursorSizeIndex=0),this.currentCursorSizeIndex=(this.currentCursorSizeIndex+1)%e.length;const o=e[this.currentCursorSizeIndex];document.documentElement.style.cursor=o.cursor;const n=document.getElementById(t);n&&(n.innerHTML=`${o.icon} Cursor Size: ${o.label}`);const i="normal"!==o.size;this.setActiveButton(t,i),console.log(`Cursor size set to: ${o.size}`)},t.prototype.initKeyboardNavigation=function(){const t=document.getElementById("keyboard-navigation-btn");t&&t.addEventListener("click",(()=>{this.keyboardNavigationActive=!this.keyboardNavigationActive,this.setActiveButton("keyboard-navigation-btn",this.keyboardNavigationActive),this.keyboardNavigationActive?(this.enableKeyboardNavigation(),this.showKeyboardNavigationPopup()):(this.disableKeyboardNavigation(),this.hideKeyboardNavigationPopup())}))},t.prototype.enableKeyboardNavigation=function(){console.log("Keyboard Navigation Enabled"),document.addEventListener("keydown",this.handleKeyboardNavigation.bind(this)),document.body.classList.add("keyboard-navigation-active")},t.prototype.disableKeyboardNavigation=function(){console.log("Keyboard Navigation Disabled"),document.removeEventListener("keydown",this.handleKeyboardNavigation.bind(this)),document.body.classList.remove("keyboard-navigation-active"),this.clearSelectionHighlight()},t.prototype.handleKeyboardNavigation=function(t){const e=Array.from(document.querySelectorAll('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter((t=>!t.disabled&&null!==t.offsetParent));let o=e.indexOf(document.activeElement);const n={ArrowDown:()=>{t.preventDefault(),o=(o+1)%e.length,e[o].focus(),this.highlightSelection(e[o])},ArrowUp:()=>{t.preventDefault(),o=(o-1+e.length)%e.length,e[o].focus(),this.highlightSelection(e[o])},Enter:()=>{document.activeElement&&document.activeElement.click()},Escape:()=>{this.disableKeyboardNavigation(),this.hideKeyboardNavigationPopup(),this.setActiveButton("keyboard-navigation-btn",!1)},F2:()=>this.showKeyboardNavigationPopup(),F3:()=>this.toggleSpeechOutput(),KeyW:()=>document.getElementById("blue-filter-btn")?.click(),KeyI:()=>document.getElementById("remove-images-btn")?.click(),KeyA:()=>document.getElementById("remove-audio-btn")?.click(),KeyR:()=>document.getElementById("read-aloud-btn")?.click(),KeyP:()=>document.getElementById("increase-text-btn")?.click(),KeyM:()=>document.getElementById("decrease-text-btn")?.click(),KeyH:()=>this.navigateToNext("heading"),KeyS:()=>this.navigateToStart(),KeyZ:()=>document.getElementById("zoom-toggle-btn")?.click(),KeyN:()=>document.getElementById("night-mode-btn")?.click(),KeyT:()=>document.getElementById("text-spacing-btn")?.click(),KeyL:()=>this.navigateToNext("list"),KeyC:()=>document.getElementById("cursor-size-btn")?.click(),KeyG:()=>this.navigateToNext("image"),KeyK:()=>this.navigateToNext("link"),KeyD:()=>this.navigateToNext("jump-tag"),KeyF:()=>this.navigateToNext("form-field"),KeyE:()=>this.navigateToNext("input-field"),KeyB:()=>this.navigateToNext("button")};n[t.code]&&n[t.code]()},t.prototype.focusElement=function(t){t&&(t.focus(),t.scrollIntoView({behavior:"smooth",block:"center"}))},t.prototype.scrollPage=function(t){const e={up:()=>window.scrollBy({top:-70,behavior:"smooth"}),down:()=>window.scrollBy({top:70,behavior:"smooth"}),left:()=>window.scrollBy({left:-70,behavior:"smooth"}),right:()=>window.scrollBy({left:70,behavior:"smooth"})};e[t]&&e[t]()},t.prototype.showKeyboardNavigationPopup=function(){if(document.getElementById("keyboard-navigation-popup"))return;const t=document.createElement("div");t.id="keyboard-navigation-popup",t.className="keyboard-popup";const e=document.createElement("div");e.className="popup-header",e.innerHTML='<h3>Instructions for the use of keyboard shortcuts</h3><button class="close-popup-btn">✖</button>',e.querySelector(".close-popup-btn").addEventListener("click",(()=>t.remove())),t.appendChild(e);const o=document.createElement("div");o.className="popup-body",[{key:"Esc",action:"Exit web page navigation"},{key:"F2",action:"Show this guide"},{key:"F3",action:"Toggle speech output"},{key:"Tab",action:"Select next item"},{key:"Shift + Tab",action:"Select previous item"},{key:"S",action:"Reset focus to start"},{key:"H",action:"Next heading"},{key:"G",action:"Next image/graphic"},{key:"K",action:"Next link"},{key:"D",action:"Next jump tag"},{key:"L",action:"Next list"},{key:"F",action:"Next form field"},{key:"E",action:"Next input field"},{key:"W",action:"Blue Filter"},{key:"I",action:"Remove Images"},{key:"A",action:"Remove Audio"},{key:"R",action:"Read Aloud"},{key:"P",action:"Increase Text Font Size"},{key:"M",action:"Decrease Text Font Size"},{key:"Z",action:"Zoom Toggle"},{key:"N",action:"Night Mode"},{key:"T",action:"Text Spacing"},{key:"C",action:"Cursor Size "}].forEach((({key:t,action:e})=>{const n=document.createElement("div");n.className="shortcut-item",n.innerHTML=`<span class="shortcut-key">${t}</span>: ${e}`,o.appendChild(n)})),t.appendChild(o),document.body.appendChild(t)},t.prototype.hideKeyboardNavigationPopup=function(){const t=document.getElementById("keyboard-navigation-popup");t&&t.remove()},t.prototype.highlightSelection=function(t){this.clearSelectionHighlight(),t&&t.classList.add("keyboard-focus")},t.prototype.clearSelectionHighlight=function(){document.querySelectorAll(".keyboard-focus").forEach((t=>t.classList.remove("keyboard-focus")))},t.prototype.navigateToNext=function(t){const e=document.querySelectorAll({heading:"h1, h2, h3, h4, h5, h6",list:"ul, ol","list-entry":"li","form-field":"form","input-field":"input, textarea, select",button:"button",link:"a",image:"img","jump-tag":"[id]"}[t]),o=document.activeElement,n=(Array.from(e).indexOf(o)+1)%e.length;e[n]&&(e[n].focus(),this.highlightSelection(e[n]))},t.prototype.navigateToStart=function(){const t=document.querySelector('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');t&&(t.focus(),this.highlightSelection(t))},t.prototype.setActiveButton=function(t,e=null){const o=document.getElementById(t);o&&((null!==e?e:"true"!==o.dataset.active)?(o.classList.add("active-button"),o.dataset.active="true"):(o.classList.remove("active-button"),o.dataset.active="false"))},t.prototype.resetButtonStates=function(){document.querySelectorAll(".syi-toolbox-button").forEach((t=>{t.style.backgroundColor="rgba(255, 255, 255, 0.3)",t.dataset.active="false"}))},t.prototype.initAccessibleFontToggle=function(){const t=document.getElementById("accessible-font-btn");t?t.addEventListener("click",(()=>{this.toggleAccessibleFont("accessible-font-btn"),console.log("Accessible font toggle button clicked.")})):console.error("Font toggle button not found.")},t.prototype.toggleAccessibleFont=function(t){const e=document.body.classList.toggle("accessible-font");this.setActiveButton(t,e),this.saveToolbarState(),console.log("Accessible font "+(e?"enabled":"disabled"))},t.prototype.initResetFeature=function(){document.querySelectorAll("#reset-btn, #reset-btn1").forEach((t=>{t.addEventListener("click",(()=>{this.resetToolbox()}))}))},t.prototype.resetToolbox=function(){this.closeAllPopups(),document.querySelectorAll(".highlight-links, .highlight-headers, .highlight-images").forEach((t=>{t.classList.remove("highlight-links","highlight-headers","highlight-images")})),document.querySelectorAll("[data-toolbox-modified]").forEach((t=>{t.closest(".font-size-popup")||t.closest(".syi-toolbox")||(t.style.fontSize="",t.style.letterSpacing="",t.style.lineHeight="",t.style.transform="",t.style.transformOrigin="",t.style.width="",t.removeAttribute("data-toolbox-modified"))}));const t=document.querySelector(".blue-overlay");t&&t.classList.remove("active");const e=document.getElementById("remove-images-btn");this.imagesHidden&&e&&(e.click(),console.log("Remove Images button triggered via reset.")),document.querySelectorAll("[data-toolbox-muted]").forEach((t=>{t.muted=!1,t.removeAttribute("data-toolbox-muted")}));const o=document.getElementById("night-mode-btn");document.body.classList.contains("night-mode")&&o&&o.click(),document.documentElement.style.cursor="auto",document.body.classList.remove("accessible-font"),document.body.classList.remove("disable-animations"),this.resetContrast();const n=document.querySelector(".settings-popup .reset-popup-btn, .settings-popup .popup-reset");n&&(n.click(),console.log("Settings popup reset triggered."));const i=document.querySelector(".font-size-popup .reset-popup-btn, .font-size-popup .popup-reset");i&&(i.click(),console.log("Font size popup reset triggered.")),localStorage.removeItem("animationsDisabled"),localStorage.removeItem("nightMode"),localStorage.removeItem("zoomLevel"),localStorage.removeItem("toolbarState"),this.applyZoom(1),document.querySelectorAll("body *:not(.syi-toolbox):not(.syi-toolbox *):not(.font-size-popup):not(.font-size-popup *)").forEach((t=>{t.style.letterSpacing="normal",t.style.lineHeight="normal",t.style.fontSize=""})),this.currentFontSize=null,languageDropdown.value=defaultSettings.language,document.documentElement.style.setProperty("--bg-color",defaultSettings.color,"important"),this.resetButtonStates(),console.log("Toolbox reset to the original state.")},t.prototype.initContrastFeature=function(){const t=document.getElementById("contrast-btn");t&&t.addEventListener("click",(()=>{this.createContrastPopup(),this.setActiveButton("contrast-btn")}))},t.prototype.createContrastPopup=function(){this.closeAllPopups();const t=document.getElementById("contrast-popup");if(t)return t.remove(),void(this.isContrastPopupActive=!1);const e=document.createElement("div");e.id="contrast-popup",e.className="contrast-popup";const o=this.createPopupHeader("Contrast Settings",(()=>{e.remove(),this.isContrastPopupActive=!1}));e.appendChild(o);const n=document.createElement("div");n.className="contrast-popup-body",this.addPresetModes(n),this.addCustomColorControls(n);const i=document.createElement("button");i.className="contrast-reset-button",i.textContent="Reset Contrast",i.addEventListener("click",(()=>this.resetContrast())),n.appendChild(i),e.appendChild(n);const s=document.createElement("button");s.className="contrast-close-button",s.textContent="X",s.addEventListener("click",(()=>{e.remove()})),n.appendChild(s),e.appendChild(n);const a=document.querySelector(".syi-toolbox");if(!a)return void console.error("Toolbox element not found!");const l=a.getBoundingClientRect();e.style.top=`${l.top+window.scrollY}px`,l.left<window.innerWidth/2?e.style.left=`${l.right+10}px`:e.style.left=l.left-400-10+"px",document.body.appendChild(e),this.isContrastPopupActive=!0},t.prototype.createPopupHeader=function(t,e){const o=document.createElement("div");o.className="contrast-popup-header";const n=document.createElement("h3");return n.className="contrast-popup-title",n.textContent=t,o.appendChild(n),o},t.prototype.addPresetModes=function(t){[{id:"grayscale",text:"Uncolored Display"}].forEach((({id:e,text:o})=>{const n=document.createElement("button");n.id=e,n.className="contrast-mode-button",n.textContent=o,n.addEventListener("click",(t=>this.toggleContrastMode(e,t.target))),t.appendChild(n)}))},t.prototype.addCustomColorControls=function(t){const e=document.createElement("div");e.className="contrast-custom-colors";const o=["#FFFFFF","#000000","#F0E68C","#ADD8E6","#FFB6C1"],n=document.createElement("label");n.textContent="Background:";const i=document.createElement("div");i.className="color-picker-container",o.forEach((t=>{const e=document.createElement("button");e.className="color-button",e.style.backgroundColor=t,e.addEventListener("click",(()=>{this.applyBackgroundColor(t)})),i.appendChild(e)}));const s=document.createElement("input");s.type="color",s.id="bg-color-picker",s.addEventListener("input",(()=>{const t=s.value;this.applyBackgroundColor(t)})),i.appendChild(s),e.appendChild(n),e.appendChild(i);const a=document.createElement("label");a.textContent="Text Color:";const l=document.createElement("div");l.className="color-picker-container",o.forEach((t=>{const e=document.createElement("button");e.className="color-button",e.style.backgroundColor=t,e.addEventListener("click",(()=>this.applyCustomTextColor(t))),l.appendChild(e)}));const c=document.createElement("input");c.type="color",c.id="text-color-picker",c.addEventListener("input",(()=>this.applyCustomTextColor(c.value))),l.appendChild(c),e.appendChild(a),e.appendChild(l),t.appendChild(e)},t.prototype.applyBackgroundColor=function(t){document.querySelectorAll("*:not(button):not(input):not(.syi-toolbox):not(.syi-toolbox *):not(.contrast-popup):not(.contrast-popup *)").forEach((e=>{e.style.background=t,e.style.backgroundColor=t})),console.log(`Background applied to all elements: ${t}`)},t.prototype.applyCustomTextColor=function(t){if(t){const e=t=>!t.closest(".syi-toolbox")&&!t.closest(".contrast-popup");document.querySelectorAll("p, h1, h2, h3, h4, h5, h6, span, li, a, div, label, input, textarea").forEach((o=>{e(o)?o.style.color=t:console.log("Excluded element:",o)})),this.customTextColor=t}},t.prototype.resetContrast=function(){document.body.classList.remove("bright-contrast","reverse-contrast","grayscale"),document.body.style.background="",document.body.style.backgroundColor="",document.body.style.color="",document.querySelectorAll("*:not(.syi-toolbox):not(.syi-toolbox *):not(.contrast-popup):not(.contrast-popup *)").forEach((t=>{t.style.background="",t.style.backgroundColor="",t.style.color="",t.classList.remove("bright-contrast","reverse-contrast","grayscale")})),console.log("Contrast settings reset to original.")},t.prototype.toggleContrastMode=function(t,e){const o=document.body.classList,n=o.contains(t);o.remove("bright-contrast","reverse-contrast","grayscale"),n?console.log(`${t} mode deactivated.`):(o.add(t),console.log(`${t} mode activated.`)),this.updateContrastButtonStates(e,n)},t.prototype.updateContrastButtonStates=function(t,e){document.querySelectorAll(".contrast-mode-button").forEach((o=>{o!==t||e?o.classList.remove("active"):o.classList.add("active")}))},t.prototype.setContrastMode=function(t){if(!t)return;const{contrastMode:e,bgColor:o,textColor:n}=t;e&&(document.body.classList.add(e),console.log(`Restored contrast mode: ${e}`)),o&&(document.body.style.backgroundColor=o,console.log(`Restored background color: ${o}`)),n&&(document.querySelectorAll("p, h1, h2, h3, h4, h5, h6, span, li, a, div, label, button, input, textarea").forEach((t=>{t.style.color=n})),console.log(`Restored text color: ${n}`))},t.prototype.saveToolbarState=function(){const t={blueFilterActive:document.querySelector(".blue-overlay")?.classList.contains("active")||!1,imagesHidden:this.imagesHidden||!1,isMuted:this.isMuted||!1,currentFontSize:this.getCurrentFontSize(),nightModeActive:document.body.classList.contains("night-mode")||!1,zoomLevel:parseFloat(localStorage.getItem("zoomLevel"))||1,textSpacingIndex:this.currentTextSpacingIndex||0,lineHeightIndex:this.currentLineHeightIndex||0,cursorSizeIndex:this.currentCursorSizeIndex||0,accessibleFont:document.body.classList.contains("accessible-font")||!1,animationsDisabled:document.body.classList.contains("disable-animations")||!1,contrastMode:this.getContrastMode(),customBackgroundColor:this.customBackgroundColor||null,customTextColor:this.customTextColor||null,activeButtons:this.getActiveButtons(),highlightedLinks:null!==document.querySelector(".highlight-links"),highlightedHeaders:null!==document.querySelector(".highlight-headers"),selectedHeaderColor:localStorage.getItem("popupHeaderColor")||null};localStorage.setItem("toolbarState",JSON.stringify(t)),console.log("Toolbar state saved:",t)},t.prototype.loadToolbarState=function(){const t=JSON.parse(localStorage.getItem("toolbarState"))||null;if(!t)return void console.log("No saved state found. Using default settings.");console.log("Restoring toolbar state:",t);const e=document.getElementById("blue-filter-btn");if(e?(this.initBlueFilter(),t.blueFilterActive&&e.click()):console.error("Blue Filter button is missing."),t.imagesHidden&&(this.toggleImages(),this.setActiveButton("remove-images-btn",!0)),t.isMuted&&(this.audioRemoval(),this.setActiveButton("remove-audio-btn",!0)),t.highlightedLinks&&(this.highlightContent("links"),this.setActiveButton("highlight-links-btn",!0)),t.highlightedHeaders&&(this.highlightContent("headers"),this.setActiveButton("highlight-headers-btn",!0)),t.nightModeActive&&(document.body.classList.add("night-mode"),this.setActiveButton("night-mode-btn",!0)),t.zoomLevel&&(this.applyZoom(t.zoomLevel),this.setActiveButton("zoom-toggle-btn",1!==t.zoomLevel)),void 0!==t.textSpacingIndex&&(this.currentTextSpacingIndex=t.textSpacingIndex-1,this.toggleTextSpacing("text-spacing-btn")),void 0!==t.lineHeightIndex&&(this.currentLineHeightIndex=t.lineHeightIndex-1,this.toggleLineHeight("line-height-btn")),void 0!==t.cursorSizeIndex&&(this.currentCursorSizeIndex=t.cursorSizeIndex-1,this.toggleCursorSize("cursor-size-btn")),e){if(this.initBlueFilter(),t.blueFilterActive){let t=document.querySelector(".blue-overlay");t||(t=this.createDiv("blue-overlay"),document.body.appendChild(t),t.classList.add("active")),this.setActiveButton("blue-filter-btn",!0)}}else console.error("Blue Filter button is missing.");if(t.currentFontSize){const e=parseFloat(t.currentFontSize)-this.getCurrentFontSize();if(e>0)for(let t=0;t<e;t++)this.adjustFontSize("increase");else if(e<0)for(let t=0;t<-e;t++)this.adjustFontSize("decrease")}t.animationsDisabled&&(document.body.classList.add("disable-animations"),this.setActiveButton("stop-animations-btn",!0)),t.highlightedButtons&&t.highlightedButtons.forEach((t=>{const e=t.includes("links")?"links":"headers";this.highlightContent(e),this.setActiveButton(t,!0)})),t.contrastMode&&(document.body.classList.add(t.contrastMode),console.log(`Restored contrast mode: ${t.contrastMode}`)),t.customBackgroundColor&&(document.body.style.backgroundColor=t.customBackgroundColor,console.log(`Restored custom background color: ${t.customBackgroundColor}`)),t.accessibleFont&&(document.body.classList.add("accessible-font"),this.setActiveButton("accessible-font-btn",!0),console.log("Restored: Accessible font enabled.")),t.customTextColor&&document.querySelectorAll("p, h1, h2, h3, h4, h5, h6, span, li, a, div, label, button, input, textarea").forEach((e=>{e.style.color=t.customTextColor})),Array.isArray(t.activeButtons)&&t.activeButtons.forEach((t=>this.setActiveButton(t,!0))),console.log("Toolbar state restored successfully.")},t.prototype.getCurrentFontSize=function(){const t=document.querySelectorAll("body *:not(.syi-toolbox):not(.syi-toolbox *)");let e=0,o=0;t.forEach((t=>{const n=window.getComputedStyle(t),i=parseFloat(n.fontSize);i&&(e+=i,o++)}));const n=o>0?e/o:16;return console.log(`Calculated average font size: ${n}px`),n},t.prototype.getContrastMode=function(){return document.body.classList.contains("grayscale")?"grayscale":null},t.prototype.getActiveButtons=function(){return Array.from(document.querySelectorAll('.syi-toolbox-button[data-active="true"]')).map((t=>t.id))},t.prototype.initSaveFeature=function(){const t=document.getElementById("save-settings-btn");t?t.addEventListener("click",(()=>{this.saveToolbarState(),console.log("Settings saved.")})):console.error("Save button not found.")},t.prototype.getHighlightedButtons=function(){const t=[];return document.querySelectorAll(".highlight-links.active").length>0&&t.push("highlight-links-btn"),document.querySelectorAll(".highlight-headers.active").length>0&&t.push("highlight-headers-btn"),t},t.prototype.resetSettings=function(){localStorage.removeItem("toolbarState"),this.resetToolbox(),console.log("Toolbar state reset.")},t.prototype.addSettingsButtonListener=function(){const t=document.getElementById("settings-btn");t?t.addEventListener("click",(()=>{this.createSettingsPopup()})):console.error("Settings button not found")},t.prototype.createSettingsPopup=function(){if(this.closeAllPopups(),document.querySelector(".settings-popup"))return;const t=this.createPopupContainer(),e=this.createPopupHeader("Settings"),o=this.createLanguageSelector(),n=this.createColorPicker(e),i=this.createPopupResetButton(e,n),s=this.createPopupCloseButton(t);t.appendChild(e),t.appendChild(o),t.appendChild(n),t.appendChild(i),t.appendChild(s),document.body.appendChild(t);const a=this.determineToolboxPosition(t);this.updatePopupPositions(a)},t.prototype.createPopupContainer=function(){const t=this.createDiv("settings-popup");return t.style.position="absolute",t.style.top="19%",t},t.prototype.createPopupHeader=function(t){const e=this.createDiv("settings-popup-header"),o=this.createHeading(3,t,"settings-popup-title");return e.appendChild(o),e},t.prototype.createLanguageSelector=function(){const t=this.createDiv("popup-section"),e=this.createEle("label",{for:"language-select"},"Select Language: "),o=this.createEle("select",{id:"language-select"});return o.innerHTML='\n        <option value="en">English</option>\n        <option value="de">German</option>\n    ',t.appendChild(e),t.appendChild(o),t},t.prototype.createColorPicker=function(t){const e=this.createDiv("popup-section"),o=this.createEle("label",{},"Pick a Color: "),n=this.createEle("input",{type:"color",id:"color-picker",value:"#007bff"});return n.addEventListener("input",(e=>{this.updateToolboxColor(t,e.target.value)})),e.appendChild(o),e.appendChild(n),e},t.prototype.createPopupResetButton=function(t,e){const o=this.createEle("button",{class:"popup-reset"},"Reset");return o.style.color="white",o.addEventListener("click",(()=>{this.resetPopupSettings(t,e)})),o},t.prototype.resetPopupSettings=function(t,e){const o="#393636";t.style.backgroundColor=o,e.querySelector("#color-picker").value=o;const n=document.querySelector(".syi-toolbox-header");n&&(n.style.backgroundColor=o),document.querySelectorAll(".syi-toolbox-body svg").forEach((t=>{t.style.fill=o,t.style.stroke=o,t.querySelectorAll("*").forEach((t=>{t.style.fill=o,t.style.stroke=o}))})),document.querySelectorAll(".syi-toolbox-body .syi-toolbox-btn, .syi-toolbox-button").forEach((t=>{t.style.backgroundColor=o,t.style.borderColor=o,t.style.color=o})),document.getElementById("language-select").value="en",document.documentElement.style.setProperty("--bg-color",o,"important")},t.prototype.createPopupCloseButton=function(t){const e=this.createEle("button",{class:"popup-close"},"X");return e.addEventListener("click",(()=>t.remove())),e},t.prototype.updateToolboxColor=function(t,e){t.style.backgroundColor=e,document.querySelectorAll(".syi-toolbox-header, .settings-popup-header").forEach((t=>{t.style.setProperty("background-color",e,"important")})),document.querySelectorAll(".syi-toolbox-body svg").forEach((t=>{t.style.fill=e,t.style.stroke=e,t.querySelectorAll("*").forEach((t=>{t.style.fill=e,t.style.stroke=e}))})),document.querySelectorAll(".syi-toolbox-body .syi-toolbox-btn, .syi-toolbox-button").forEach((t=>{t.style.backgroundColor=e,t.style.borderColor=e})),document.documentElement.style.setProperty("--bg-color",e,"important")},t.prototype.determineToolboxPosition=function(t){const e=document.querySelector(".syi-toolbox").getBoundingClientRect().left<window.innerWidth/2;return t.style.left=e?"28%":"71%",e},t.prototype.closeAllPopups=function(t){[".settings-popup",".contrast-popup",".font-size-popup"].forEach((e=>{if(e!==t){const t=document.querySelector(e);if(t&&!t.matches(".syi-toolbox-body")&&!t.closest(".syi-toolbox-body"))if(".font-size-popup"===e){const e=t.querySelector("#close-font-popup");e&&(e.addEventListener("click",(e=>{e.stopPropagation(),t.style.display="none"})),e.click())}else t.remove()}}))},t.prototype.addDevelopmentAlerts=function(){["remove-audio-btn","highlight-links-btn","highlight-headers-btn","stop-animations-btn","zoom-toggle-btn","cursor-size-btn","accessible-font-btn","read-aloud-btn","save-settings-btn"].forEach((t=>{const e=document.getElementById(t);e?e.addEventListener("click",(()=>{alert("Function under development.")})):console.warn(`Button with ID '${t}' not found.`)}))},document.addEventListener("DOMContentLoaded",(()=>{new t,function(){const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css",t.type="text/css",document.head.appendChild(t)}()})),{}})()));